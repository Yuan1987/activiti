<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.dynastech.system.mapper.UserMapper">
	<resultMap id="BaseResultMap" type="com.dynastech.system.entity.User">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 26 
			18:19:56 CST 2017. -->
		<id column="u_Id" property="id" jdbcType="CHAR" />
		<result column="u_AccountName" property="accountname" jdbcType="NVARCHAR" />
		<result column="u_Birthday" property="birthday" jdbcType="TIMESTAMP" />
		<result column="u_DateTimeCreated" property="datetimecreated"
			jdbcType="TIMESTAMP" />
		<result column="u_DateTimeModified" property="datetimemodified"
			jdbcType="TIMESTAMP" />
		<result column="u_Description" property="description" jdbcType="NVARCHAR" />
		<result column="u_DisplayName" property="displayname" jdbcType="NVARCHAR" />
		<result column="u_ExtensionData" property="extensiondata"
			jdbcType="NVARCHAR" />
		<result column="u_FirstName" property="firstname" jdbcType="NVARCHAR" />
		<result column="u_IdNumber" property="idnumber" jdbcType="NVARCHAR" />
		<result column="u_IsDeleted" property="isdeleted" jdbcType="BIT" />
		<result column="u_IsEnabled" property="isenabled" jdbcType="BIT" />
		<result column="u_LastName" property="lastname" jdbcType="NVARCHAR" />
		<result column="u_MiddleName" property="middlename" jdbcType="NVARCHAR" />
		<result column="u_Name" property="name" jdbcType="NVARCHAR" />
		<result column="u_Sex" property="sex" jdbcType="INTEGER" />
		<result column="u_Sn" property="sn" jdbcType="INTEGER" />
		<result column="u_Type" property="type" jdbcType="NVARCHAR" />
		<result column="u_WorkNumber" property="worknumber" jdbcType="NVARCHAR" />
		
		<!-- 扩展 -->
    	<result column="orgName" property="orgName" jdbcType="NVARCHAR"/>
	</resultMap>
	<sql id="Example_Where_Clause">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 26 
			18:19:56 CST 2017. -->
		<where>
			<foreach collection="oredCriteria" item="criteria" separator="or">
				<if test="criteria.valid">
					<trim prefix="(" suffix=")" prefixOverrides="and">
						<foreach collection="criteria.criteria" item="criterion">
							<choose>
								<when test="criterion.noValue">
									and ${criterion.condition}
								</when>
								<when test="criterion.singleValue">
									and ${criterion.condition} #{criterion.value}
								</when>
								<when test="criterion.betweenValue">
									and ${criterion.condition} #{criterion.value} and
									#{criterion.secondValue}
								</when>
								<when test="criterion.listValue">
									and ${criterion.condition}
									<foreach collection="criterion.value" item="listItem"
										open="(" close=")" separator=",">
										#{listItem}
									</foreach>
								</when>
							</choose>
						</foreach>
					</trim>
				</if>
			</foreach>
		</where>
	</sql>
	<sql id="Update_By_Example_Where_Clause">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 26 
			18:19:56 CST 2017. -->
		<where>
			<foreach collection="example.oredCriteria" item="criteria"
				separator="or">
				<if test="criteria.valid">
					<trim prefix="(" suffix=")" prefixOverrides="and">
						<foreach collection="criteria.criteria" item="criterion">
							<choose>
								<when test="criterion.noValue">
									and ${criterion.condition}
								</when>
								<when test="criterion.singleValue">
									and ${criterion.condition} #{criterion.value}
								</when>
								<when test="criterion.betweenValue">
									and ${criterion.condition} #{criterion.value} and
									#{criterion.secondValue}
								</when>
								<when test="criterion.listValue">
									and ${criterion.condition}
									<foreach collection="criterion.value" item="listItem"
										open="(" close=")" separator=",">
										#{listItem}
									</foreach>
								</when>
							</choose>
						</foreach>
					</trim>
				</if>
			</foreach>
		</where>
	</sql>
	<sql id="Base_Column_List">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 26 
			18:19:56 CST 2017. -->
		u.Id as u_Id, u.AccountName as u_AccountName, u.Birthday as
		u_Birthday, u.DateTimeCreated as u_DateTimeCreated,
		u.DateTimeModified as u_DateTimeModified, u.Description as u_Description, u.DisplayName
		as u_DisplayName,
		u.ExtensionData as u_ExtensionData, u.FirstName as u_FirstName, u.IdNumber as
		u_IdNumber,
		u.IsDeleted as u_IsDeleted, u.IsEnabled as u_IsEnabled, u.LastName as u_LastName,
		u.MiddleName as u_MiddleName, u.Name as u_Name, u.Sex as u_Sex, u.Sn
		as u_Sn, u.Type as u_Type,
		u.WorkNumber as u_WorkNumber
	</sql>
	<select id="selectByExample" resultMap="BaseResultMap"
		parameterType="com.dynastech.system.entity.UserExample">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 26 
			18:19:56 CST 2017. -->
		select
		<if test="distinct">
			distinct
		</if>
		<include refid="Base_Column_List" />
		from RS_User u
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
		<if test="orderByClause != null">
			order by ${orderByClause}
		</if>
	</select>
	<select id="selectByPrimaryKey" resultMap="BaseResultMap"
		parameterType="java.lang.String">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 26 
			18:19:56 CST 2017. -->
		select
		<include refid="Base_Column_List" />
		from RS_User u
		where u.Id = #{id,jdbcType=CHAR}
	</select>
	<delete id="deleteByPrimaryKey" parameterType="java.lang.String">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 26 
			18:19:56 CST 2017. -->
		delete from RS_User
		where Id = #{id,jdbcType=CHAR}
	</delete>
	<delete id="deleteByExample" parameterType="com.dynastech.system.entity.UserExample">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 26 
			18:19:56 CST 2017. -->
		delete from RS_User u
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
	</delete>
	<insert id="insert" parameterType="com.dynastech.system.entity.User">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 26 
			18:19:56 CST 2017. -->
		insert into RS_User (Id, AccountName, Birthday,
		DateTimeCreated, DateTimeModified,
		Description, DisplayName, ExtensionData,
		FirstName, IdNumber, IsDeleted,
		IsEnabled, LastName, MiddleName,
		Name, Sex, Sn, Type,
		WorkNumber)
		values (#{id,jdbcType=CHAR}, #{accountname,jdbcType=NVARCHAR},
		#{birthday,jdbcType=TIMESTAMP},
		#{datetimecreated,jdbcType=TIMESTAMP}, #{datetimemodified,jdbcType=TIMESTAMP},
		#{description,jdbcType=NVARCHAR}, #{displayname,jdbcType=NVARCHAR},
		#{extensiondata,jdbcType=NVARCHAR},
		#{firstname,jdbcType=NVARCHAR}, #{idnumber,jdbcType=NVARCHAR}, #{isdeleted,jdbcType=BIT},
		#{isenabled,jdbcType=BIT}, #{lastname,jdbcType=NVARCHAR},
		#{middlename,jdbcType=NVARCHAR},
		#{name,jdbcType=NVARCHAR}, #{sex,jdbcType=INTEGER}, #{sn,jdbcType=INTEGER},
		#{type,jdbcType=NVARCHAR},
		#{worknumber,jdbcType=NVARCHAR})
	</insert>
	<insert id="insertSelective" parameterType="com.dynastech.system.entity.User">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 26 
			18:19:56 CST 2017. -->
		insert into RS_User
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="id != null">
				Id,
			</if>
			<if test="accountname != null">
				AccountName,
			</if>
			<if test="birthday != null">
				Birthday,
			</if>
			<if test="datetimecreated != null">
				DateTimeCreated,
			</if>
			<if test="datetimemodified != null">
				DateTimeModified,
			</if>
			<if test="description != null">
				Description,
			</if>
			<if test="displayname != null">
				DisplayName,
			</if>
			<if test="extensiondata != null">
				ExtensionData,
			</if>
			<if test="firstname != null">
				FirstName,
			</if>
			<if test="idnumber != null">
				IdNumber,
			</if>
			<if test="isdeleted != null">
				IsDeleted,
			</if>
			<if test="isenabled != null">
				IsEnabled,
			</if>
			<if test="lastname != null">
				LastName,
			</if>
			<if test="middlename != null">
				MiddleName,
			</if>
			<if test="name != null">
				Name,
			</if>
			<if test="sex != null">
				Sex,
			</if>
			<if test="sn != null">
				Sn,
			</if>
			<if test="type != null">
				Type,
			</if>
			<if test="worknumber != null">
				WorkNumber,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="id != null">
				#{id,jdbcType=CHAR},
			</if>
			<if test="accountname != null">
				#{accountname,jdbcType=NVARCHAR},
			</if>
			<if test="birthday != null">
				#{birthday,jdbcType=TIMESTAMP},
			</if>
			<if test="datetimecreated != null">
				#{datetimecreated,jdbcType=TIMESTAMP},
			</if>
			<if test="datetimemodified != null">
				#{datetimemodified,jdbcType=TIMESTAMP},
			</if>
			<if test="description != null">
				#{description,jdbcType=NVARCHAR},
			</if>
			<if test="displayname != null">
				#{displayname,jdbcType=NVARCHAR},
			</if>
			<if test="extensiondata != null">
				#{extensiondata,jdbcType=NVARCHAR},
			</if>
			<if test="firstname != null">
				#{firstname,jdbcType=NVARCHAR},
			</if>
			<if test="idnumber != null">
				#{idnumber,jdbcType=NVARCHAR},
			</if>
			<if test="isdeleted != null">
				#{isdeleted,jdbcType=BIT},
			</if>
			<if test="isenabled != null">
				#{isenabled,jdbcType=BIT},
			</if>
			<if test="lastname != null">
				#{lastname,jdbcType=NVARCHAR},
			</if>
			<if test="middlename != null">
				#{middlename,jdbcType=NVARCHAR},
			</if>
			<if test="name != null">
				#{name,jdbcType=NVARCHAR},
			</if>
			<if test="sex != null">
				#{sex,jdbcType=INTEGER},
			</if>
			<if test="sn != null">
				#{sn,jdbcType=INTEGER},
			</if>
			<if test="type != null">
				#{type,jdbcType=NVARCHAR},
			</if>
			<if test="worknumber != null">
				#{worknumber,jdbcType=NVARCHAR},
			</if>
		</trim>
	</insert>
	<select id="countByExample" parameterType="com.dynastech.system.entity.UserExample"
		resultType="java.lang.Integer">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 26 
			18:19:56 CST 2017. -->
		select count(*) from RS_User u
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
	</select>
	<update id="updateByExampleSelective" parameterType="map">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 26 
			18:19:56 CST 2017. -->
		update RS_User u
		<set>
			<if test="record.id != null">
				u.Id = #{record.id,jdbcType=CHAR},
			</if>
			<if test="record.accountname != null">
				u.AccountName = #{record.accountname,jdbcType=NVARCHAR},
			</if>
			<if test="record.birthday != null">
				u.Birthday = #{record.birthday,jdbcType=TIMESTAMP},
			</if>
			<if test="record.datetimecreated != null">
				u.DateTimeCreated = #{record.datetimecreated,jdbcType=TIMESTAMP},
			</if>
			<if test="record.datetimemodified != null">
				u.DateTimeModified = #{record.datetimemodified,jdbcType=TIMESTAMP},
			</if>
			<if test="record.description != null">
				u.Description = #{record.description,jdbcType=NVARCHAR},
			</if>
			<if test="record.displayname != null">
				u.DisplayName = #{record.displayname,jdbcType=NVARCHAR},
			</if>
			<if test="record.extensiondata != null">
				u.ExtensionData = #{record.extensiondata,jdbcType=NVARCHAR},
			</if>
			<if test="record.firstname != null">
				u.FirstName = #{record.firstname,jdbcType=NVARCHAR},
			</if>
			<if test="record.idnumber != null">
				u.IdNumber = #{record.idnumber,jdbcType=NVARCHAR},
			</if>
			<if test="record.isdeleted != null">
				u.IsDeleted = #{record.isdeleted,jdbcType=BIT},
			</if>
			<if test="record.isenabled != null">
				u.IsEnabled = #{record.isenabled,jdbcType=BIT},
			</if>
			<if test="record.lastname != null">
				u.LastName = #{record.lastname,jdbcType=NVARCHAR},
			</if>
			<if test="record.middlename != null">
				u.MiddleName = #{record.middlename,jdbcType=NVARCHAR},
			</if>
			<if test="record.name != null">
				u.Name = #{record.name,jdbcType=NVARCHAR},
			</if>
			<if test="record.sex != null">
				u.Sex = #{record.sex,jdbcType=INTEGER},
			</if>
			<if test="record.sn != null">
				u.Sn = #{record.sn,jdbcType=INTEGER},
			</if>
			<if test="record.type != null">
				u.Type = #{record.type,jdbcType=NVARCHAR},
			</if>
			<if test="record.worknumber != null">
				u.WorkNumber = #{record.worknumber,jdbcType=NVARCHAR},
			</if>
		</set>
		<if test="_parameter != null">
			<include refid="Update_By_Example_Where_Clause" />
		</if>
	</update>
	<update id="updateByExample" parameterType="map">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 26 
			18:19:56 CST 2017. -->
		update RS_User u
		set u.Id = #{record.id,jdbcType=CHAR},
		u.AccountName = #{record.accountname,jdbcType=NVARCHAR},
		u.Birthday = #{record.birthday,jdbcType=TIMESTAMP},
		u.DateTimeCreated = #{record.datetimecreated,jdbcType=TIMESTAMP},
		u.DateTimeModified = #{record.datetimemodified,jdbcType=TIMESTAMP},
		u.Description = #{record.description,jdbcType=NVARCHAR},
		u.DisplayName = #{record.displayname,jdbcType=NVARCHAR},
		u.ExtensionData = #{record.extensiondata,jdbcType=NVARCHAR},
		u.FirstName = #{record.firstname,jdbcType=NVARCHAR},
		u.IdNumber = #{record.idnumber,jdbcType=NVARCHAR},
		u.IsDeleted = #{record.isdeleted,jdbcType=BIT},
		u.IsEnabled = #{record.isenabled,jdbcType=BIT},
		u.LastName = #{record.lastname,jdbcType=NVARCHAR},
		u.MiddleName = #{record.middlename,jdbcType=NVARCHAR},
		u.Name = #{record.name,jdbcType=NVARCHAR},
		u.Sex = #{record.sex,jdbcType=INTEGER},
		u.Sn = #{record.sn,jdbcType=INTEGER},
		u.Type = #{record.type,jdbcType=NVARCHAR},
		u.WorkNumber = #{record.worknumber,jdbcType=NVARCHAR}
		<if test="_parameter != null">
			<include refid="Update_By_Example_Where_Clause" />
		</if>
	</update>
	<update id="updateByPrimaryKeySelective" parameterType="com.dynastech.system.entity.User">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 26 
			18:19:56 CST 2017. -->
		update RS_User
		<set>
			<if test="accountname != null">
				AccountName = #{accountname,jdbcType=NVARCHAR},
			</if>
			<if test="birthday != null">
				Birthday = #{birthday,jdbcType=TIMESTAMP},
			</if>
			<if test="datetimecreated != null">
				DateTimeCreated = #{datetimecreated,jdbcType=TIMESTAMP},
			</if>
			<if test="datetimemodified != null">
				DateTimeModified = #{datetimemodified,jdbcType=TIMESTAMP},
			</if>
			<if test="description != null">
				Description = #{description,jdbcType=NVARCHAR},
			</if>
			<if test="displayname != null">
				DisplayName = #{displayname,jdbcType=NVARCHAR},
			</if>
			<if test="extensiondata != null">
				ExtensionData = #{extensiondata,jdbcType=NVARCHAR},
			</if>
			<if test="firstname != null">
				FirstName = #{firstname,jdbcType=NVARCHAR},
			</if>
			<if test="idnumber != null">
				IdNumber = #{idnumber,jdbcType=NVARCHAR},
			</if>
			<if test="isdeleted != null">
				IsDeleted = #{isdeleted,jdbcType=BIT},
			</if>
			<if test="isenabled != null">
				IsEnabled = #{isenabled,jdbcType=BIT},
			</if>
			<if test="lastname != null">
				LastName = #{lastname,jdbcType=NVARCHAR},
			</if>
			<if test="middlename != null">
				MiddleName = #{middlename,jdbcType=NVARCHAR},
			</if>
			<if test="name != null">
				Name = #{name,jdbcType=NVARCHAR},
			</if>
			<if test="sex != null">
				Sex = #{sex,jdbcType=INTEGER},
			</if>
			<if test="sn != null">
				Sn = #{sn,jdbcType=INTEGER},
			</if>
			<if test="type != null">
				Type = #{type,jdbcType=NVARCHAR},
			</if>
			<if test="worknumber != null">
				WorkNumber = #{worknumber,jdbcType=NVARCHAR},
			</if>
		</set>
		where Id = #{id,jdbcType=CHAR}
	</update>
	<update id="updateByPrimaryKey" parameterType="com.dynastech.system.entity.User">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Wed Jul 26 
			18:19:56 CST 2017. -->
		update RS_User
		set AccountName = #{accountname,jdbcType=NVARCHAR},
		Birthday = #{birthday,jdbcType=TIMESTAMP},
		DateTimeCreated = #{datetimecreated,jdbcType=TIMESTAMP},
		DateTimeModified = #{datetimemodified,jdbcType=TIMESTAMP},
		Description = #{description,jdbcType=NVARCHAR},
		DisplayName = #{displayname,jdbcType=NVARCHAR},
		ExtensionData = #{extensiondata,jdbcType=NVARCHAR},
		FirstName = #{firstname,jdbcType=NVARCHAR},
		IdNumber = #{idnumber,jdbcType=NVARCHAR},
		IsDeleted = #{isdeleted,jdbcType=BIT},
		IsEnabled = #{isenabled,jdbcType=BIT},
		LastName = #{lastname,jdbcType=NVARCHAR},
		MiddleName = #{middlename,jdbcType=NVARCHAR},
		Name = #{name,jdbcType=NVARCHAR},
		Sex = #{sex,jdbcType=INTEGER},
		Sn = #{sn,jdbcType=INTEGER},
		Type = #{type,jdbcType=NVARCHAR},
		WorkNumber = #{worknumber,jdbcType=NVARCHAR}
		where Id = #{id,jdbcType=CHAR}
	</update>

	
	<!-- 包含下级数据<select id="selectUsersByOrgId" parameterType="map" resultMap="BaseResultMap">
		select * from ( select distinct
		<include refid="Base_Column_List" />
		from RS_User u,RS_OrganizationDepth
		orgd,RS_OrganizationUser orgu 
		where u.Id=orgu.UserId and
		orgu.OrganizationId=orgd.ChildId
		and orgd.ParentId=#{orgId,jdbcType=CHAR}
		and u.IsDeleted=0
		<if test="str !=null and str !='' ">
			and (u.accountname like concat('%',#{str},'%') or
			u.DisplayName like
			concat('%',#{str},'%') )
		</if>
		) u
	</select> -->
	<!-- 只查本级 -->
	<select id="selectUsersByOrgId" parameterType="map" resultMap="BaseResultMap">
		select 
		<include refid="Base_Column_List" />
		from RS_User u,RS_OrganizationUser orgu 
		where u.Id=orgu.UserId
		and orgu.OrganizationId=#{orgId,jdbcType=CHAR}
		and u.IsDeleted=0
		<if test="str !=null and str !='' ">
			and (u.accountname like concat('%',#{str},'%') or
			u.DisplayName like
			concat('%',#{str},'%') )
		</if>
	</select>
	
	<select id="findLeadersByOrgId" parameterType="map" resultMap="BaseResultMap">
		select 
		<include refid="Base_Column_List" />
		from RS_User u,RS_OrganizationUser orgu 
		where u.Id=orgu.UserId
		and orgu.OrganizationId in 
		<foreach close=")" collection="orgIds" item="id" open="("
			separator=",">
			#{id,jdbcType=CHAR}
		</foreach>
		and u.IsDeleted=0
	</select>
	
	<select id="findUsersByRoleName" parameterType="map" resultMap="BaseResultMap">
		select distinct <include refid="Base_Column_List" />
			 from RS_User u ,RS_RoleUser ru ,RS_Role r
		where u.Id=ru.UserId
		and r.Id=ru.RoleId
		and r.Name=#{roleName}
		and u.IsDeleted=0
	</select>
	
</mapper>